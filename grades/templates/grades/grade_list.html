{% extends 'student/base.html' %}
{% block title %}Danh sách điểm số{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Danh sách điểm số</h2>
    <div>
        <a href="{% url 'grade_create' %}" class="btn btn-primary">+ Thêm điểm</a>
        <a href="{% url 'bulk_grade_create' %}" class="btn btn-success">Nhập điểm hàng loạt</a>
    </div>
</div>

<form method="get" class="mb-3">
    <div class="row">
        <div class="col-md-4">
            <label class="form-label">Học kỳ:</label>
            <select name="hoc_ky" class="form-select">
                <option value="">Tất cả</option>
                {% for value, label in HOC_KY_CHOICES %}
                    <option value="{{ value }}" {% if hoc_ky == value %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-4">
            <label class="form-label">Năm học:</label>
            <input type="text" name="nam_hoc" class="form-control" value="{{ nam_hoc }}">
        </div>
        <div class="col-md-4">
            <label class="form-label">&nbsp;</label>
            <button type="submit" class="btn btn-primary d-block">Lọc</button>
        </div>
    </div>
</form>

{% if grades %}
    <table class="table table-striped table-bordered">
        <thead class="table-dark">
            <tr>
                <th>Mã SV</th>
                <th>Họ tên</th>
                <th>Môn học</th>
                <th>Học kỳ</th>
                <th>Năm học</th>
                <th>Điểm tổng kết</th>
                <th>Thao tác</th>
            </tr>
        </thead>
        <tbody>
            {% for grade in grades %}
                <tr>
                    <td>{{ grade.student.ma_sv }}</td>
                    <td>{{ grade.student.ho_ten }}</td>
                    <td>{{ grade.subject.ten_mon }}</td>
                    <td>HK{{ grade.hoc_ky }}</td>
                    <td>{{ grade.nam_hoc }}</td>
                    <td><strong>{{ grade.diem_tong_ket|default:"-" }}</strong></td>
                    <td>
                        <a href="{% url 'grade_update' grade.pk %}" class="btn btn-sm btn-warning">Sửa</a>
                        <a href="{% url 'grade_delete' grade.pk %}" class="btn btn-sm btn-danger">Xóa</a>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <div class="alert alert-info">Chưa có điểm số nào.</div>
{% endif %}
{% endblock %}

